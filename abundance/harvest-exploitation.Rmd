---

---

```{r setup, include=FALSE}

knitr::opts_knit$set(root.dir = "~/RProjects/SturgeonPopMetrics")

```

```{r libraries}

library(dplyr)
library(spopmodel)

```

```{r load-data}

SturgeonAll <- readRDS(file = "data/tagging/SturgeonAll.rds")
AnglerTagReturn <- readRDS(file = "data/tagging/AnglerTagReturn.rds")


```

```{r somevars}




```

```{r}

# head(SturgeonAll)

# number legal-sized (at tagging) WST tagged
wst_tagged <- SturgeonAll %>% 
  filter(
    Species %in% "White" &
      StuType %in% "Tag" &
      LenCat %in% "leg" &
      RelYear > 1997 &
      TagVal > 0
  ) %>% 
  group_by(RelYear, TagVal) %>% 
  summarise(NumRel = n())



```


```{r}

head(AnglerTagReturn)

angler_returns <- AnglerTagReturn %>% 
  filter(
    Species %in% "White" &
      RetYear %in% 1 &
      LenCat %in% "leg" &
      RelYear > 1997 &
      TagVal > 0
  ) %>% 
  group_by(RelYear, TagVal) %>% 
  summarise(NumRet = n())


```

```{r}

head(wst_tagged)
head(angler_returns)

rel_ret <- merge(
  x = wst_tagged,
  y = angler_returns,
  all = TRUE,
  by = c("RelYear", "TagVal")
)

rel_ret$NumRet[is.na(rel_ret$NumRet)] <- 0


```


```{r}

rel_ret[rel_ret$RelYear %in% 2001, ]

barplot(height = rel_ret$NumRet, col = 1:3)


ReportingRate()


# Exploitation

```



```{r eval=FALSE}

par(mar = c(3.0, 4, 1, 1) + 0.1, bty = "u")

plot(
  formula = WSTBS ~ Year,
  data = indices,
  type = "b",
  las = 1,
  ylab = "Index",
  xaxt = "n",
  xlab = NA
)

axis(
  side = 1,
  at = (1980:2016)[(1980:2016) %% 5 == 0],
  labels = (1980:2016)[(1980:2016) %% 5 == 0],
  tck = -0.03,
  padj = -0.5
)

axis(
  side = 1,
  at = 1980:2016,
  labels = NA,
  tck = -0.01
)

mtext(text = "Year", side = 1, line = 1.5)


```

